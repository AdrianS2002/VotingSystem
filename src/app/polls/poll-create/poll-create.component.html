<div class="poll-create-container">
  <h2>Creează un sondaj</h2>
  
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="spinner"></div>
  </div>

  <form (ngSubmit)="createPoll()">
    <div class="form-section">
      <div class="subject-field">
    <label for="subject-input">Subiect:</label>
    <input 
      id="subject-input"
      [(ngModel)]="poll.subject" 
      name="subject" 
      required 
      placeholder="Introduceți subiectul sondajului"
      autocomplete="off">
  </div>

      <label>Opțiuni:</label>
      <div *ngFor="let option of poll.options; let i = index" class="option-container">
        <input [(ngModel)]="option.text" [name]="'option' + i" required placeholder="Opțiunea {{i+1}}">
        <button type="button" class="remove-option" (click)="removeOption(i)">X</button>
      </div>
      <button type="button" class="add-option" (click)="addOption()">+ Adaugă opțiune</button>
    </div>

    <div class="form-section">
      <div class="section-title">Setări de vizibilitate</div>
      
      <label>Vizibilitate:</label>
      <select [(ngModel)]="poll.visibility" name="visibility">
        <option value="public">Public</option>
        <option value="registered">Utilizatori înregistrați</option>
        <option value="private">Anumite persoane</option>
      </select>

      <div *ngIf="poll.visibility === 'private'" class="private-voters">
        <label>Emailuri votanți (separate prin virgulă):</label>
        <input [(ngModel)]="voterEmails" name="voterEmails" placeholder="email1@example.com, email2@example.com">
      </div>
    </div>

    <div class="form-section">
      <div class="section-title">Setări de rezultate</div>
      
      <label>Reguli afișare rezultate:</label>
      <select [(ngModel)]="poll.resultsVisibility" name="resultsVisibility">
        <option value="live">Live</option>
        <option value="after100Votes">După 100 voturi</option>
        <option value="afterExpiration">După expirare</option>
        <option value="afterAllVoted">După ce toți au votat</option>
      </select>
    </div>

<div class="form-section">
  <div class="section-title">Perioadă</div>
  
  <div class="form-group">
    <label>Dată publicare:</label>
    <input 
      type="datetime-local" 
      [(ngModel)]="poll.publishDate" 
      name="publishDate"
      (change)="dateValidation = validateDates()">
  </div>

  <div class="form-group">
    <label>Dată expirare:</label>
     
    <input 
      type="datetime-local" 
      [(ngModel)]="poll.expiresAt" 
      name="expiresAt"
      (change)="dateValidation = validateDates()">
  </div>

  <div 
    *ngIf="dateValidation && !dateValidation.valid" 
    class="validation-error">
    {{ dateValidation.message }}
  </div>
</div>

<button type="submit">Creează sondaj</button>
</form>

<!-- Success Message with Share URL -->
<div *ngIf="isPollCreated" class="success-overlay">
  <div class="success-container">
    <div class="success-header">
      <i class="fas fa-check-circle"></i>
      <h3>Sondaj creat cu succes!</h3>
    </div>
    
    <p>Utilizează link-ul de mai jos pentru a distribui sondajul:</p>
    
    <div class="share-url-container">
      <input #urlInput type="text" [value]="pollShareUrl" readonly class="share-url-input">
      <button type="button" class="copy-btn" (click)="copyShareUrl(urlInput)">
        <i class="fas fa-copy"></i> Copiază
      </button>
    </div>
    
    <div class="success-actions">
      <a [routerLink]="['/polls', createdPollId]" class="btn btn-primary">
        Vezi sondajul
      </a>
      <a [routerLink]="['/my-polls']" class="btn btn-secondary">
        Toate sondajele mele
      </a>
    </div>
  </div>
</div>
</div>